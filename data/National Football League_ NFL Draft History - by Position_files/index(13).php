YUI.add('share-bar',function(Y){var L=Y.Lang,A=Y.Array,O=Y.Object,CBOX='contentBox',BBOX='boundingBox',EVENT_BUTTON_CLICK='shareBar:button-click',BTN_G_PLUS='google-plus',BTN_FB_LIKE='facebook-like',BTN_SHARE='share',BTN_PRINT='print';if(!YUI.Env.ShareBar)YUI.Env.ShareBar={};if(!YUI.Env.ShareBar.registry)YUI.Env.ShareBar.registry={};var ShareBar=Y.Base.create('shareBar',Y.Widget,[],{_userAction:null,_checkTimer:null,_eventHandles:null,_fbMouseOverHandle:null,_gpMouseOverHandle:null,_mediaTypeList:['image','flash','mp3'],initializer:function(config){var barId=this.get('barId'),ua,params;if(!barId){console.error('share bar widget requires \'barId\'');return;};if(this.get('register')){var containerId=this.get('containerId'),w=YUI.Env.ShareBar.registry[containerId];if(w&&Y.instanceOf(w,Y.Base)){w.destroy();}
YUI.Env.ShareBar.registry[containerId]=this;}
this._eventHandles=[];this.publish(EVENT_BUTTON_CLICK,{emitFacade:true,broadcast:2});this.publish("shared",{emitFacade:true,broadcast:2});},renderUI:function(){this._loadBar();},bindUI:function(){var that=this,button;if(this.hasButton(BTN_SHARE)){button=Y.one('#'+this.get('barId'));this._eventHandles.push(button.on('click',function(e){Y.use('gigya-socialize',Y.bind(this._showShareUI,this));this.fire(EVENT_BUTTON_CLICK,{type:BTN_SHARE,id:this.get('containerId')});},this));this._eventHandles.push(button.one('img').on({mouseover:function(e){this.set('src',that.get('shareIconImgOver'));},mouseout:function(e){this.set('src',that.get('shareIconImgUp'));}}));}
if(this.hasButton(BTN_FB_LIKE)){button=this.get(CBOX).one('.gig-button-container-facebook-like');if(button&&this.get('lazyLoad')){this._fbMouseOverHandle=button.one('.share-bar-fbLike-img').on('mouseover',Y.bind(function(button,e){if(this._fbMouseOverHandle){this._fbMouseOverHandle.detach();this._fbMouseOverHandle=null;}
button.set('innerHTML',L.sub(this.getFBLikeTpl(),{fbLikeHref:this.get('linkBack'),fbLikeColorScheme:this.get('fbLikeColorScheme')}));this._parseFbButton(button._node);},this,button),this);}}
if(this.hasButton(BTN_G_PLUS)){button=this.get(CBOX).one('.gig-button-container-gplus');if(button&&this.get('lazyLoad')){this._gpMouseOverHandle=button.one('.share-bar-gplus-img').on('mouseover',Y.bind(function(button,e){if(this._gpMouseOverHandle){this._gpMouseOverHandle.detach();this._gpMouseOverHandle=null;}
if(Y.UA.ie&&Y.UA.ie<=8){var gPlusOne=document.createElement('g:plusone');gPlusOne.setAttribute('size','medium');gPlusOne.setAttribute('count','false');gPlusOne.setAttribute('annotation','none');gPlusOne.setAttribute('href',this.get('linkBack'));button.empty().appendChild(gPlusOne);}else{button.set('innerHTML',L.sub(this.getGPlusTpl(),{gPlusHref:this.get('linkBack')}));}
this._parseGPlusButton(button._node);},this,button),this);}}
if(this.hasButton(BTN_PRINT)){button=this.get(CBOX).one('.gig-button-container-print a');this._eventHandles.push(button.on('click',function(e){e.halt();this.fire(EVENT_BUTTON_CLICK,{type:BTN_PRINT,id:this.get('containerId')});},this));this._eventHandles.push(button.one('img').on({mouseover:function(e){this.set('src',that.get('printIconImgOver'));},mouseout:function(e){this.set('src',that.get('printIconImgUp'));}}));}},syncUI:function(){if(!this.get(CBOX).hasClass(this.getMainClass())){this.get(CBOX).addClass(this.getMainClass());}
if(!this.get(CBOX).hasClass(this.getSkinClass())){this.get(CBOX).addClass(this.getSkinClass());}},_onSendDone:function(){console.log("_onSendDone",arguments);this.fire("shared",Y.Array(arguments));},_onError:function(){console.log("_onError(share-bar)",arguments);},_initUserAction:function(){this._userAction=new gigya.services.socialize.UserAction();ua=this._userAction;ua.setUserMessage(this.get('userMessage'));ua.setTitle(this.get('title'));ua.setLinkBack(this.get('linkBack'));ua.setDescription(this.get('description'));if(this.get('actionName'))ua.setActionName(this.get('actionName'));if(this.get('actionLink').title&&this.get('actionLink').href){ua.addActionLink(this.get('actionLink').title,this.get('actionLink').href);}
if(this.get('mediaItem').length>0){A.each(this.get('mediaItem'),function(n){if(L.isObject(n)&&n.type&&A.indexOf(this._mediaTypeList,n.type)!=-1){ua.addMediaItem(n);}},this);}
params={initialView:'more',operationMode:'multiSelect',enabledProviders:'facebook,twitter',moreEnabledProviders:'facebook,twitter,googleplus',shortURLs:'never',userAction:ua,scope:this.get('scope'),privacy:this.get('privacy'),onSendDone:Y.bind("_onSendDone",this),onError:Y.bind("_onError",this)};if(this.get('feedID'))params.feedID=this.get('feedID');if(this.get('cid'))params.cid=this.get('cid');this.set('params',params);},_showShareUI:function(){if(!this.get('params')){this._initUserAction();}
gigya.services.socialize.showShareUI(this.get('conf'),this.get('params'));},_loadBar:function(){var buttonsTpl=[],lazyLoad=this.get('lazyLoad'),tpl='',substitute={};if(this.get('enableBuzz')){tpl=this.BUZZ_TEMPLATE;buttonsTpl.push(tpl);}
A.each(this.get('shareButtons'),function(button,i){switch(button.provider){case BTN_FB_LIKE:var fbLikeTpl=lazyLoad?this.getFBLikeImgTpl():this.getFBLikeTpl();tpl=L.sub(this.FB_LIKE_TEMPLATE,{fbLikeTpl:fbLikeTpl});if(lazyLoad){substitute.fbLikeImage=nfl.constants.IMAGE_PATH+'/img/share-bar/fb-like.png';}else{substitute.fbLikeHref=this.get('linkBack');substitute.fbLikeColorScheme=this.get('fbLikeColorScheme');}
tpl=L.sub(tpl,substitute);break;case BTN_G_PLUS:var gPlusTpl=lazyLoad?this.getGPlusImgTpl():this.getGPlusTpl();tpl=L.sub(this.G_PLUS_TEMPLATE,{gPlusTpl:gPlusTpl});if(lazyLoad){substitute.gPlusImage=nfl.constants.IMAGE_PATH+'/img/share-bar/g-plus.png';}else{substitute.gPlusHref=this.get('linkBack');}
tpl=L.sub(tpl,substitute);break;case BTN_SHARE:substitute.barId=this.get('barId');substitute.shareImage=this.get('shareIconImgUp');tpl=L.sub(this.SHARE_TEMPLATE,substitute);break;case BTN_PRINT:substitute.printImage=this.get('printIconImgUp');tpl=L.sub(this.PRINT_TEMPLATE,substitute);break;}
buttonsTpl.push(tpl);},this);this.get('srcNode').set('innerHTML',L.sub(this.getTpl(),{buttonsTpl:buttonsTpl.join('')}));if(!lazyLoad)this._parseFbButton();if(!lazyLoad)this._parseGPlusButton();},_checkLikeButtonWidth:function(){var node=this.get(CBOX).one('.gig-button-container-facebook-like');if(node&&node.one('span')){this._checkTimer.cancel();node.one('span').setStyles({display:'block',overflow:'hidden',width:46});}},_parseFbButton:function(node){var that=this,parseFn=function(){FB.Event.subscribe('xfbml.render',function(){FB.Event.subscribe('edge.create',function(url){that.fire(EVENT_BUTTON_CLICK,{type:BTN_FB_LIKE,id:that.get('containerId'),url:url});});FB.Event.subscribe('edge.remove',function(url){});});FB.XFBML.parse(node||this.get(CBOX).one('.gig-button-container-facebook-like')._node);that._checkTimer=Y.later('1000',that,'_checkLikeButtonWidth',[],true);};if(!window.FB){var timer=Y.later(500,null,function(){if(window.FB&&window.FB._apiKey){parseFn();timer.cancel();timer=null;}},[],true);}else{parseFn();}},_parseGPlusButton:function(node){var that=this,parseFn=function(){gapi.plusone.render(node._node,{size:'medium',annotation:'none',href:that.get('linkBack'),callback:Y.bind(function(){that.fire(EVENT_BUTTON_CLICK,{type:BTN_G_PLUS,id:that.get('containerId'),url:that.get('linkBack')});},that)});};if(!window.gapi){Y.Get.script('//apis.google.com/js/plusone.js',{onSuccess:parseFn});}else{parseFn();}},setUserAction:function(params){if(!params||!L.isObject(params))return;Y.use('gigya-socialize',Y.bind(this._setUserAction,this,params));},_setUserAction:function(params){this._userAction=new gigya.services.socialize.UserAction();ua=this._userAction;if(params.userMessage){this.set('userMessage',params.userMessage);}
ua.setUserMessage(this.get('userMessage'));if(params.title){this.set('title',params.title);}
ua.setTitle(this.get('title'));if(params.linkBack){this.set('linkBack',params.linkBack);}
ua.setLinkBack(this.get('linkBack'));if(params.description){this.set('description',params.description);}
ua.setDescription(this.get('description'));if(params.actionLink){this.set('actionLink',params.actionLink);}
ua.addActionLink(this.get('actionLink').title,this.get('actionLink').href);if(params.actionName){this.set('actionName',params.actionName);}
ua.setActionName(this.get('actionName'));if(params.mediaItem){var mediaItem=[];if(L.isArray(params.mediaItem)){if(params.mediaItem.length>0){A.each(params.mediaItem,function(n){if(L.isObject(n)&&n.type&&A.indexOf(this._mediaTypeList,n.type)!=-1){mediaItem.push(n);}},this);}}else if(L.isObject(params.mediaItem)){if(params.mediaItem.type&&A.indexOf(this._mediaTypeList,params.mediaItem.type)!=-1){mediaItem.push(params.mediaItem);}}
if(mediaItem.length>0){this.set('mediaItem',mediaItem);}}
if(this.get('mediaItem').length>0){A.each(this.get('mediaItem'),function(n){ua.addMediaItem(n);},this);}
this.set('params.userAction',this._userAction);},addMediaItem:function(mediaItem){var item=[];if(mediaItem){if(L.isArray(mediaItem)){if(mediaItem.length>0){A.each(mediaItem,function(n){if(L.isObject(n)&&n.type&&A.indexOf(this._mediaTypeList,n.type)!=-1){this._userAction.addMediaItem(n);item.push(n);}},this);}}else if(L.isObject(mediaItem)){if(mediaItem.type&&A.indexOf(this._mediaTypeList,mediaItem.type)!=-1){this._userAction.addMediaItem(mediaItem);item.push(mediaItem);}}
this.set('mediaItem',this.get('mediaItem').concat(item));}
this.set('params.userAction',this._userAction);},hasButton:function(type){return A.some(this.get('shareButtons'),function(btn){return btn.provider==type;});},getSkinClass:function(){return'skin-'+this.get('skinName');},getMainClass:function(){return'share-bar';},getFBLikeTpl:function(){return'<fb:like href="{fbLikeHref}" action="like" width="55" show_faces="false" font="" layout="button_count" colorscheme="{fbLikeColorScheme}" ref="fbLike"></fb:like>';},getGPlusTpl:function(){return'<g:plusone count="false" size="medium" href="{gPlusHref}"></g:plusone>';},getFBLikeImgTpl:function(){return'<a class="share-bar-fbLike-img" href="javascript: void(0);" style="float: left;"><img src="{fbLikeImage}"/></a>';},getGPlusImgTpl:function(){return'<a class="share-bar-gplus-img" href="javascript: void(0);" style="float: left;"><img src="{gPlusImage}"/></a>';},FB_LIKE_TEMPLATE:'<div class="gig-button-container gig-button-container-facebook-like gig-share-button-container gig-facebookLikeButton-button_count">'+'{fbLikeTpl}'+'</div>',G_PLUS_TEMPLATE:'<div class="gig-button-container gig-button-container-gplus gig-share-button-container gig-gplusLikeButton-button_count">'+'{gPlusTpl}'+'</div>',SHARE_TEMPLATE:'<div class="gig-button-container gig-button-container-share gig-share-button-container">'+'<a id="{barId}" href="javascript: void(0);" style="float: left;"><img src="{shareImage}"/></a>'+'</div>',PRINT_TEMPLATE:'<div class="gig-button-container gig-button-container-print gig-share-button-container">'+'<a href="javascript: void(0);" style="float: left;"><img src="{printImage}"/></a>'+'</div>',BUZZ_TEMPLATE:'<div class="buzz">'+'<a href="javascript: void(0);">'+'<div class="buzz-meter-container">'+'<div class="buzz-meter">'+'<span class="out-of"></span>'+'<span class="value"></span>'+'</div>'+'</div>'+'</a>'+'</div>',getTpl:function(){return'<div class="share-bar-bg share-bar-bg-l"></div>'+'<div class="share-bar-bg share-bar-bg-l-ex"></div>'+'<div class="share-bar-bg share-bar-bg-c">'+'{buttonsTpl}'+'</div>'+'<div class="share-bar-bg share-bar-bg-r-ex"></div>'+'<div class="share-bar-bg share-bar-bg-r"></div>';},_shareButtonsValidator:function(value){var valid=false,wl=[BTN_FB_LIKE,'facebook-send',BTN_G_PLUS,'google-plus','google-plusone',BTN_SHARE,'email',BTN_PRINT];if(L.isArray(value)){valid=value.length>0&&A.every(value,function(n){return n.provider&&A.indexOf(wl,n.provider)!=-1;});}else if(L.isString(value)){var arr=value.split(',');valid=A.every(arr,function(n){return A.indexOf(wl,n)!=-1;});}
return valid;},_purge:function(){Y.one('#'+this.get('barId')).purge(true);Y.one('#'+this.get('barId')).empty();},destructor:function(){A.each(this._eventHandles,function(handle,i){if(handle)handle.detach();});this._purge();if(this.get('register')&&YUI.Env.ShareBar.registry[this.get('containerId')]){YUI.Env.ShareBar.registry[this.get('containerId')]=null;}}},{ATTRS:{containerId:{valueFn:function(){return this.get('srcNode').getAttribute('id');}},barId:{valueFn:function(){return this.get('srcNode').getAttribute('id')+'-bar'+L.now();}},conf:{value:nfl.constants.GIGYA_CONF},feedID:{value:null,validator:L.isString},cid:{value:null,validator:L.isString},register:{value:true,writeOnce:true},skinName:{value:'default',validator:L.isString},lazyLoad:{value:true},params:{value:null},enableBuzz:{value:false,validator:L.isBoolean},userMessage:{value:'',validator:L.isString},title:{value:window.document.title,validator:L.isString},linkBack:{value:window.location.href,getter:function(value){var siteUrl=nfl.constants.SITE_URL,anchor=document.createElement('a'),origin,isExternal;anchor.href=value;origin=[anchor.protocol,anchor.host].join('//');isExternal=origin!==siteUrl;if(!isExternal){value=value.replace(origin,'');}
return isExternal?value:siteUrl+'/m/share?p='+encodeURIComponent(value);},validator:function(value){return value&&value.substr(0,4)==='http';}},description:{value:'',validator:L.isString},actionLink:{value:{title:'',href:''},validator:function(value){return value&&L.isString(value.title)&&L.isString(value.href);}},actionName:{value:'',validator:L.isString},mediaItem:{value:[],validator:L.isArray},shareButtons:{value:[{provider:BTN_FB_LIKE,enableCount:true},{provider:BTN_SHARE,enableCount:false}],setter:function(value){A.each(value,function(n){if(L.isObject(n)&&n.provider){if(n.provider==BTN_FB_LIKE){n.colorscheme=this.get('fbLikeColorScheme');}else if(n.provider==BTN_SHARE){n.iconImgUp=this.get('shareIconImgUp');n.iconImgOver=this.get('shareIconImgOver');}}},this);return value;},validator:'_shareButtonsValidator'},shareIconImgUp:{value:nfl.constants.IMAGE_PATH+'/img/share-bar/share-button.png'},shareIconImgOver:{value:nfl.constants.IMAGE_PATH+'/img/share-bar/share-button-over.png'},printIconImgUp:{value:nfl.constants.IMAGE_PATH+'/img/share-bar/print.png'},printIconImgOver:{value:nfl.constants.IMAGE_PATH+'/img/share-bar/print-over.png'},fbLikeColorScheme:{value:'light',validator:function(value){return value=='light'||value=='dark';}},scope:{value:'both',validator:function(value){return value=='both'||value=='external';}},privacy:{value:'public',validator:function(value){return value=='private'||value=='friends'||value=='public';}}},getInstance:function(id){return YUI.Env.ShareBar.registry[id];},HTML_PARSER:{containerId:function(srcNode){return srcNode.getAttribute('id');}},EVENT_BUTTON_CLICK:EVENT_BUTTON_CLICK,BTN_FB_LIKE:BTN_FB_LIKE,BTN_G_PLUS:BTN_G_PLUS,BTN_SHARE:BTN_SHARE,BTN_PRINT:BTN_PRINT});Y.namespace('NFL').ShareBar=ShareBar;},'3.3.0',{requires:['base','widget','array-extras','share-bar-style'],optional:['gigya-socialize']});;YUI.add('nfl-omniture',function(Y){var GlobalEnv=YUI.namespace('Env.NFLOmnitureTracking'),CLICK='click',body,OmnitureTracking,YObject=Y.Object,YLang=Y.Lang,CLICK_NAME_ATTRIBUTE='data-clickname';OmnitureTracking=Y.Base.create('nfl-omniture',Y.Base,[],{linkTrackVars:function(name,obj){OmnitureTracking.linkTrackVars(name,obj);}},{CLICK_NAME_ATTRIBUTE:CLICK_NAME_ATTRIBUTE,linkTrackVars:function(n,o){console.log('linkTrackVars()',n,o);var keys=[],values=[],name=n,obj=o,ltv=s_analytics.linkTrackVars;if(YLang.isObject(n)){obj=name;name='';}
if(s_analytics){YObject.each(obj,function(value,key){s_analytics[key]=value;keys.push(key);values.push(value);});s_analytics.linkTrackVars=keys.join(',');s_analytics.tl(true,'o',name||values.join(','));s_analytics.linkTrackVars=ltv;YObject.each(obj,function(value,key){s_analytics[key]='';});}},trackLinkVars:function(value){this.trackLink(true,'o',value,{prop35:value});},trackLink:function(d,t,n,o){console.log('trackLink()',o);if(Y.Lang.isObject(o)){o.linkTrackVars=Y.Object.keys(o).join(',');if(o.events){o.linkTrackEvents=o.events;}}
if(s_analytics){s_analytics.tl(d,t,n,o);}},trackPageLoad:function(o){console.log('trackPageLoad()',o);if(Y.Lang.isObject(o)){o.linkTrackVars=Y.Object.keys(o).join(',');if(o.events){o.linkTrackEvents=o.events;}}
if(s_analytics){s_analytics.t(o);}},getS:function(){return Y.config.win.s||s_analytics;},getInstance:function(){Y.error('Y.NFL.OmnitureTracking is now a static class, no need to call getInstance()');return new OmnitureTracking();}});if(!GlobalEnv.initialized){GlobalEnv.initialized=true;body=Y.one(Y.config.doc.body);GlobalEnv.clickNameHandler=Y.delegate(CLICK,function(event){if(event.button!==1){return;}
OmnitureTracking.linkTrackVars({prop35:event.currentTarget.getAttribute(CLICK_NAME_ATTRIBUTE)});event._nflOmnitureTracked=true;},body,'['+CLICK_NAME_ATTRIBUTE+']');GlobalEnv.externalClickHandler=Y.delegate(CLICK,function(event){var link=event.currentTarget,m,attrs={},keys=["pos","id","module"];if(event._nflOmnitureTracked||event.button!==1||event._event.returnValue===false){return;}
m=link.get("href").match(/\/tickets\/([^?]+)/);if(m){OmnitureTracking.trackLink(this,'o','Ticketmaster Click',{eVar16:"Ticketmaster",eVar17:'outbound link',eVar18:link.get("href")});}
m=link.get("href").match(/(?:\?|&)module=([^#&]+)/);if(m){attrs.module=m[1];m=link.getAttribute("name").match(/&l(id|pos)=([^&]+)&l(id|pos)=([^&]+)/);if(m){attrs[m[1]]=m[2];attrs[m[3]]=m[4];}}else{Y.Array.each(keys,function(key){var attr="data-tracking-"+key,el=link.ancestor("["+attr+"]",true);if(el){attrs[key]=el.getAttribute(attr);}});}
if(Y.Object.keys(attrs).length===keys.length){s_analytics.c_w('SC_NFLLINKS',[attrs.id,attrs.pos,attrs.module].join("|"));}},body,'a[href]');Y.on('unload',function(){GlobalEnv.clickNameHandler.detach();GlobalEnv.externalClickHandler.detach();});}
Y.namespace('NFL').OmnitureTracking=OmnitureTracking;},"3.3.0",{requires:['base','node','event-delegate']});